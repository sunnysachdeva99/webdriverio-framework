"use strict";

require("source-map-support/register");

var _chai = require("chai");

var _index = require("../build/index.js");

var _testdata = require("./testdata");

const fs = require('fs-extra');

const path = require('path');

const log4js = require('log4js');

log4js.configure({
  // configure to use all types in different files.
  appenders: {
    fileLog: {
      type: 'file',
      filename: "logs/console.log"
    },
    'out': {
      type: 'stdout',
      layout: {
        type: 'basic'
      }
    }
  },
  categories: {
    file: {
      appenders: ['fileLog'],
      level: 'debug'
    },
    default: {
      appenders: ['out', 'fileLog'],
      level: 'debug'
    }
  }
});
let logger = log4js.getLogger("default");
let reportAggregator = new _index.ReportAggregator({
  outputDir: './reports/html-reports/',
  filename: 'master-report.html',
  reportTitle: 'Master Report',
  templateFilename: path.resolve(__dirname, '../templates/wdio-html-reporter-alt-template.hbs'),
  showInBrowser: true,
  LOG: logger
});
reportAggregator.clean();
let htmlReporter = new _index.HtmlReporter({
  debug: false,
  outputDir: './reports/html-reports/',
  filename: 'report.html',
  reportTitle: 'Unit Test Report Title',
  showInBrowser: false,
  LOG: logger
});
describe('HtmlReporter', () => {
  before(function () {});
  describe('on create', function () {
    it('should verify initial properties', function () {
      (0, _chai.expect)(Array.isArray(htmlReporter.suiteUids)).to.equal(true);
      (0, _chai.expect)(htmlReporter.suiteUids.length).to.equal(0);
      (0, _chai.expect)(Array.isArray(htmlReporter.suites)).to.equal(true);
      (0, _chai.expect)(htmlReporter.suites.length).to.deep.equal(0);
      (0, _chai.expect)(htmlReporter.indents).to.equal(0);
      (0, _chai.expect)(htmlReporter.suiteIndents).to.deep.equal({});
      (0, _chai.expect)(htmlReporter.defaultTestIndent).to.equal('   ');
      (0, _chai.expect)(htmlReporter.metrics).to.deep.equal({
        passed: 0,
        skipped: 0,
        failed: 0,
        start: 0,
        end: 0,
        duration: 0
      });
    });
  });
  describe('onRunnerStart', function () {
    before(function () {
      htmlReporter.onRunnerStart(_testdata.RUNNER);
    });
    it('should set cid', function () {
      (0, _chai.expect)(htmlReporter.cid).to.equal(_testdata.RUNNER.cid);
    });
  });
  describe('onSuiteStart', function () {
    before(function () {
      htmlReporter.onSuiteStart(_testdata.SUITES[0]);
    });
    it('should add to suiteUids', function () {
      (0, _chai.expect)(htmlReporter.suiteUids.length).to.equal(1);
      (0, _chai.expect)(htmlReporter.suiteUids[0]).to.equal('Foo test1');
      (0, _chai.expect)(htmlReporter.suiteUid).to.equal('Foo test1');
    });
    it('should increase suiteIndents', function () {
      (0, _chai.expect)(htmlReporter.suiteIndents['Foo test1']).to.equal(1);
    });
  });
  describe('onTestStart', function () {
    before(function () {
      htmlReporter.onTestStart(_testdata.SUITES[0].tests[0]);
    });
  });
  describe('onTestPass', function () {
    before(function () {
      htmlReporter.onTestPass(_testdata.SUITES[0].tests[0]);
    });
    it('should increase metrics.passed by 1', function () {
      (0, _chai.expect)(htmlReporter.metrics.passed).to.equal(1);
    });
    after(function () {
      htmlReporter.onTestEnd(_testdata.SUITES[0].tests[0]);
    });
  });
  describe('onTestStart', function () {
    before(function () {
      htmlReporter.onTestStart(_testdata.SUITES[0].tests[1]);
    });
  });
  describe('onTestFail', function () {
    before(function () {
      htmlReporter.onTestFail(_testdata.SUITES[0].tests[1]);
    });
    it('should increase metrics.failed by 1', function () {
      (0, _chai.expect)(htmlReporter.metrics.failed).to.equal(1);
    });
    after(function () {
      htmlReporter.onTestEnd(_testdata.SUITES[0].tests[1]);
    });
  });
  describe('onTestStart', function () {
    before(function () {
      htmlReporter.onTestStart(_testdata.SUITES[0].tests[2]);
    });
  });
  describe('onTestSkip', function () {
    before(function () {
      htmlReporter.onTestSkip(_testdata.SUITES[0].tests[2]);
    });
    it('should increase metrics.skipped by 1', function () {
      (0, _chai.expect)(htmlReporter.metrics.skipped).to.equal(1);
    });
    after(function () {
      htmlReporter.onTestEnd(_testdata.SUITES[0].tests[2]);
    });
  });
  describe('onTestEnd', function () {
    before(function () {
      htmlReporter.onTestEnd(_testdata.SUITES[0].tests[0]);
      htmlReporter.onTestEnd(_testdata.SUITES[0].tests[1]);
      htmlReporter.onTestEnd(_testdata.SUITES[0].tests[2]);
    });
  });
  describe('onSuiteEnd', function () {
    before(function () {
      htmlReporter.onSuiteEnd(_testdata.SUITES[0]);
    });
    it('should decrease indents', function () {
      (0, _chai.expect)(htmlReporter.indents).to.equal(0);
    });
    it('should add the suite to the suites array', function () {
      (0, _chai.expect)(htmlReporter.suites.length).to.equal(1); // expect(htmlReporter.suites[0]).to.equal(SUITES[0])
    });
  });
  describe('onRunnerEnd', function () {
    it('should call htmlOutput method', function () {
      htmlReporter.onRunnerEnd(_testdata.RUNNER);
      let reportFile = path.join(process.cwd(), htmlReporter.options.outputDir, htmlReporter.suiteUid, htmlReporter.cid, htmlReporter.options.filename);
      (0, _chai.expect)(fs.existsSync(reportFile)).to.equal(true);
    });
    it('should invoke the reportAggregator', function () {
      (async () => {
        await reportAggregator.createReport();
        (0, _chai.expect)(fs.existsSync(reportAggregator.options.reportFile)).to.equal(true);
      })();
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3Rlc3QvcmVwb3J0ZXIuc3BlYy5qcyJdLCJuYW1lcyI6WyJmcyIsInJlcXVpcmUiLCJwYXRoIiwibG9nNGpzIiwiY29uZmlndXJlIiwiYXBwZW5kZXJzIiwiZmlsZUxvZyIsInR5cGUiLCJmaWxlbmFtZSIsImxheW91dCIsImNhdGVnb3JpZXMiLCJmaWxlIiwibGV2ZWwiLCJkZWZhdWx0IiwibG9nZ2VyIiwiZ2V0TG9nZ2VyIiwicmVwb3J0QWdncmVnYXRvciIsIlJlcG9ydEFnZ3JlZ2F0b3IiLCJvdXRwdXREaXIiLCJyZXBvcnRUaXRsZSIsInRlbXBsYXRlRmlsZW5hbWUiLCJyZXNvbHZlIiwiX19kaXJuYW1lIiwic2hvd0luQnJvd3NlciIsIkxPRyIsImNsZWFuIiwiaHRtbFJlcG9ydGVyIiwiSHRtbFJlcG9ydGVyIiwiZGVidWciLCJkZXNjcmliZSIsImJlZm9yZSIsIml0IiwiQXJyYXkiLCJpc0FycmF5Iiwic3VpdGVVaWRzIiwidG8iLCJlcXVhbCIsImxlbmd0aCIsInN1aXRlcyIsImRlZXAiLCJpbmRlbnRzIiwic3VpdGVJbmRlbnRzIiwiZGVmYXVsdFRlc3RJbmRlbnQiLCJtZXRyaWNzIiwicGFzc2VkIiwic2tpcHBlZCIsImZhaWxlZCIsInN0YXJ0IiwiZW5kIiwiZHVyYXRpb24iLCJvblJ1bm5lclN0YXJ0IiwiUlVOTkVSIiwiY2lkIiwib25TdWl0ZVN0YXJ0IiwiU1VJVEVTIiwic3VpdGVVaWQiLCJvblRlc3RTdGFydCIsInRlc3RzIiwib25UZXN0UGFzcyIsImFmdGVyIiwib25UZXN0RW5kIiwib25UZXN0RmFpbCIsIm9uVGVzdFNraXAiLCJvblN1aXRlRW5kIiwib25SdW5uZXJFbmQiLCJyZXBvcnRGaWxlIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJvcHRpb25zIiwiZXhpc3RzU3luYyIsImNyZWF0ZVJlcG9ydCJdLCJtYXBwaW5ncyI6Ijs7OztBQUVBOztBQUNBOztBQUNBOztBQUpBLE1BQU1BLEVBQUUsR0FBR0MsT0FBTyxDQUFD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clxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcclxuaW1wb3J0IHtleHBlY3R9IGZyb20gJ2NoYWknO1xyXG5pbXBvcnQge0h0bWxSZXBvcnRlciwgUmVwb3J0QWdncmVnYXRvcn0gZnJvbSAnLi4vYnVpbGQvaW5kZXguanMnO1xyXG5pbXBvcnQge1JVTk5FUiwgU1VJVEVTfSBmcm9tICcuL3Rlc3RkYXRhJztcclxuY29uc3QgbG9nNGpzID0gcmVxdWlyZSAoJ2xvZzRqcycpIDtcclxuXHJcbmxvZzRqcy5jb25maWd1cmUoeyAvLyBjb25maWd1cmUgdG8gdXNlIGFsbCB0eXBlcyBpbiBkaWZmZXJlbnQgZmlsZXMuXHJcbiAgICBhcHBlbmRlcnM6IHtcclxuICAgICAgICBmaWxlTG9nOiB7XHJcbiAgICAgICAgICAgIHR5cGU6ICdmaWxlJyxcclxuICAgICAgICAgICAgZmlsZW5hbWU6IFwibG9ncy9jb25zb2xlLmxvZ1wiXHJcbiAgICAgICAgfSxcclxuICAgICAgICAnb3V0Jzoge1xyXG4gICAgICAgICAgICB0eXBlOiAnc3Rkb3V0JyxcclxuICAgICAgICAgICAgbGF5b3V0OiB7dHlwZTogJ2Jhc2ljJ31cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgY2F0ZWdvcmllczoge1xyXG4gICAgICAgIGZpbGU6IHthcHBlbmRlcnM6IFsnZmlsZUxvZyddLCBsZXZlbDogJ2RlYnVnJ30sXHJcbiAgICAgICAgZGVmYXVsdDoge2FwcGVuZGVyczogWydvdXQnLCAnZmlsZUxvZyddLCBsZXZlbDogJ2RlYnVnJ31cclxuICAgIH1cclxufSk7XHJcblxyXG5sZXQgbG9nZ2VyID0gbG9nNGpzLmdldExvZ2dlcihcImRlZmF1bHRcIikgO1xyXG5cclxubGV0IHJlcG9ydEFnZ3JlZ2F0b3IgPSBuZXcgUmVwb3J0QWdncmVnYXRvcih7XHJcbiAgICBvdXRwdXREaXI6ICcuL3JlcG9ydHMvaHRtbC1yZXBvcnRzLycsXHJcbiAgICBmaWxlbmFtZTogJ21hc3Rlci1yZXBvcnQuaHRtbCcsXHJcbiAgICByZXBvcnRUaXRsZTogJ01hc3RlciBSZXBvcnQnLFxyXG4gICAgdGVtcGxhdGVGaWxlbmFtZTogcGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJy4uL3RlbXBsYXRlcy93ZGlvLWh0bWwtcmVwb3J0ZXItYWx0LXRlbXBsYXRlLmhicycpLFxyXG4gICAgc2hvd0luQnJvd3NlcjogdHJ1ZSxcclxuICAgIExPRyA6IGxvZ2dlclxyXG59KTtcclxucmVwb3J0QWdncmVnYXRvci5jbGVhbigpO1xyXG5cclxubGV0IGh0bWxSZXBvcnRlciAgPSBuZXcgSHRtbFJlcG9ydGVyKHtcclxuICAgIGRlYnVnOiBmYWxzZSxcclxuICAgIG91dHB1dERpcjogJy4vcmVwb3J0cy9odG1sLXJlcG9ydHMvJyxcclxuICAgIGZpbGVuYW1lOiAncmVwb3J0Lmh0bWwnLFxyXG4gICAgcmVwb3J0VGl0bGU6ICdVbml0IFRlc3QgUmVwb3J0IFRpdGxlJyxcclxuICAgIHNob3dJbkJyb3dzZXI6IGZhbHNlLFxyXG4gICAgTE9HIDogbG9nZ2VyXHJcbn0pO1xyXG5cclxuZGVzY3JpYmUoJ0h0bWxSZXBvcnRlcicsICgpID0+IHtcclxuICAgIGJlZm9yZShmdW5jdGlvbiAoKSB7XHJcblxyXG5cclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdvbiBjcmVhdGUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCB2ZXJpZnkgaW5pdGlhbCBwcm9wZXJ0aWVzJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShodG1sUmVwb3J0ZXIuc3VpdGVVaWRzKSkudG8uZXF1YWwodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChodG1sUmVwb3J0ZXIuc3VpdGVVaWRzLmxlbmd0aCkudG8uZXF1YWwoMCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGh0bWxSZXBvcnRlci5zdWl0ZXMpKS50by5lcXVhbCh0cnVlKTtcclxuICAgICAgICAgICAgZXhwZWN0KGh0bWxSZXBvcnRlci5zdWl0ZXMubGVuZ3RoKS50by5kZWVwLmVxdWFsKDApO1xyXG4gICAgICAgICAgICBleHBlY3QoaHRtbFJlcG9ydGVyLmluZGVudHMpLnRvLmVxdWFsKDApO1xyXG4gICAgICAgICAgICBleHBlY3QoaHRtbFJlcG9ydGVyLnN1aXRlSW5kZW50cykudG8uZGVlcC5lcXVhbCh7fSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChodG1sUmVwb3J0ZXIuZGVmYXVsdFRlc3RJbmRlbnQpLnRvLmVxdWFsKCcgICAnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGh0bWxSZXBvcnRlci5tZXRyaWNzKS50by5kZWVwLmVxdWFsKHtcclxuICAgICAgICAgICAgICAgIHBhc3NlZDogMCxcclxuICAgICAgICAgICAgICAgIHNraXBwZWQ6IDAsXHJcbiAgICAgICAgICAgICAgICBmYWlsZWQ6IDAsXHJcbiAgICAgICAgICAgICAgICBzdGFydDogMCxcclxuICAgICAgICAgICAgICAgIGVuZDogMCxcclxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAwXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxuICAgIGRlc2NyaWJlKCdvblJ1bm5lclN0YXJ0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGJlZm9yZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGh0bWxSZXBvcnRlci5vblJ1bm5lclN0YXJ0KFJVTk5FUik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBzZXQgY2lkJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBleHBlY3QoaHRtbFJlcG9ydGVyLmNpZCkudG8uZXF1YWwoUlVOTkVSLmNpZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIGRlc2NyaWJlKCdvblN1aXRlU3RhcnQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYmVmb3JlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaHRtbFJlcG9ydGVyLm9uU3VpdGVTdGFydChTVUlURVNbMF0pXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBhZGQgdG8gc3VpdGVVaWRzJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBleHBlY3QoaHRtbFJlcG9ydGVyLnN1aXRlVWlkcy5sZW5ndGgpLnRvLmVxdWFsKDEpO1xyXG4gICAgICAgICAgICBleHBlY3QoaHRtbFJlcG9ydGVyLnN1aXRlVWlkc1swXSkudG8uZXF1YWwoJ0ZvbyB0ZXN0MScpXHJcbiAgICAgICAgICAgIGV4cGVjdChodG1sUmVwb3J0ZXIuc3VpdGVVaWQpLnRvLmVxdWFsKCdGb28gdGVzdDEnKVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGluY3JlYXNlIHN1aXRlSW5kZW50cycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZXhwZWN0KGh0bWxSZXBvcnRlci5zdWl0ZUluZGVudHNbJ0ZvbyB0ZXN0MSddKS50by5lcXVhbCgxKVxyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnb25UZXN0U3RhcnQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYmVmb3JlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaHRtbFJlcG9ydGVyLm9uVGVzdFN0YXJ0KFNVSVRFU1swXS50ZXN0c1swXSlcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgZGVzY3JpYmUoJ29uVGVzdFBhc3MnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYmVmb3JlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaHRtbFJlcG9ydGVyLm9uVGVzdFBhc3MoU1VJVEVTWzBdLnRlc3RzWzBdKVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGluY3JlYXNlIG1ldHJpY3MucGFzc2VkIGJ5IDEnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGV4cGVjdChodG1sUmVwb3J0ZXIubWV0cmljcy5wYXNzZWQpLnRvLmVxdWFsKDEpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYWZ0ZXIoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBodG1sUmVwb3J0ZXIub25UZXN0RW5kKFNVSVRFU1swXS50ZXN0c1swXSlcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdvblRlc3RTdGFydCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBiZWZvcmUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBodG1sUmVwb3J0ZXIub25UZXN0U3RhcnQoU1VJVEVTWzBdLnRlc3RzWzFdKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICBkZXNjcmliZSgnb25UZXN0RmFpbCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBiZWZvcmUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBodG1sUmVwb3J0ZXIub25UZXN0RmFpbChTVUlURVNbMF0udGVzdHNbMV0pXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaW5jcmVhc2UgbWV0cmljcy5mYWlsZWQgYnkgMScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZXhwZWN0KGh0bWxSZXBvcnRlci5tZXRyaWNzLmZhaWxlZCkudG8uZXF1YWwoMSlcclxuICAgICAgICB9KTtcclxuICAgICAgICBhZnRlcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGh0bWxSZXBvcnRlci5vblRlc3RFbmQoU1VJVEVTWzBdLnRlc3RzWzFdKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ29uVGVzdFN0YXJ0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGJlZm9yZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGh0bWxSZXBvcnRlci5vblRlc3RTdGFydChTVUlURVNbMF0udGVzdHNbMl0pXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIGRlc2NyaWJlKCdvblRlc3RTa2lwJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGJlZm9yZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGh0bWxSZXBvcnRlci5vblRlc3RTa2lwKFNVSVRFU1swXS50ZXN0c1syXSlcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBpbmNyZWFzZSBtZXRyaWNzLnNraXBwZWQgYnkgMScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZXhwZWN0KGh0bWxSZXBvcnRlci5tZXRyaWNzLnNraXBwZWQpLnRvLmVxdWFsKDEpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYWZ0ZXIoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBodG1sUmVwb3J0ZXIub25UZXN0RW5kKFNVSVRFU1swXS50ZXN0c1syXSlcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdvblRlc3RFbmQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYmVmb3JlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaHRtbFJlcG9ydGVyLm9uVGVzdEVuZChTVUlURVNbMF0udGVzdHNbMF0pO1xyXG4gICAgICAgICAgICBodG1sUmVwb3J0ZXIub25UZXN0RW5kKFNVSVRFU1swXS50ZXN0c1sxXSk7XHJcbiAgICAgICAgICAgIGh0bWxSZXBvcnRlci5vblRlc3RFbmQoU1VJVEVTWzBdLnRlc3RzWzJdKTtcclxuICAgICAgICB9KVxyXG5cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICBkZXNjcmliZSgnb25TdWl0ZUVuZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBiZWZvcmUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBodG1sUmVwb3J0ZXIub25TdWl0ZUVuZChTVUlURVNbMF0pXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgZGVjcmVhc2UgaW5kZW50cycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZXhwZWN0KGh0bWxSZXBvcnRlci5pbmRlbnRzKS50by5lcXVhbCgwKVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGFkZCB0aGUgc3VpdGUgdG8gdGhlIHN1aXRlcyBhcnJheScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZXhwZWN0KGh0bWxSZXBvcnRlci5zdWl0ZXMubGVuZ3RoKS50by5lcXVhbCgxKVxyXG4gICAgICAgICAgICAvLyBleHBlY3QoaHRtbFJlcG9ydGVyLnN1aXRlc1swXSkudG8uZXF1YWwoU1VJVEVTWzBdKVxyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgZGVzY3JpYmUoJ29uUnVubmVyRW5kJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGl0KCdzaG91bGQgY2FsbCBodG1sT3V0cHV0IG1ldGhvZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaHRtbFJlcG9ydGVyLm9uUnVubmVyRW5kKFJVTk5FUik7XHJcbiAgICAgICAgICAgIGxldCByZXBvcnRGaWxlID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIGh0bWxSZXBvcnRlci5vcHRpb25zLm91dHB1dERpciwgaHRtbFJlcG9ydGVyLnN1aXRlVWlkLCBodG1sUmVwb3J0ZXIuY2lkLCBodG1sUmVwb3J0ZXIub3B0aW9ucy5maWxlbmFtZSlcclxuICAgICAgICAgICAgZXhwZWN0KGZzLmV4aXN0c1N5bmMocmVwb3J0RmlsZSkpLnRvLmVxdWFsKHRydWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGl0KCdzaG91bGQgaW52b2tlIHRoZSByZXBvcnRBZ2dyZWdhdG9yJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVwb3J0QWdncmVnYXRvci5jcmVhdGVSZXBvcnQoKTtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChmcy5leGlzdHNTeW5jKHJlcG9ydEFnZ3JlZ2F0b3Iub3B0aW9ucy5yZXBvcnRGaWxlKSkudG8uZXF1YWwodHJ1ZSk7XHJcbiAgICAgICAgICAgIH0pKCk7XHJcblxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59KTtcclxuIl19